{% extends 'base.html' %}

{% block title %}My Blogs - Django Blog{% endblock %}

{% block content %}
<h2>My Blog Posts</h2>

<p><a href="{% url 'blog_create' %}">Create New Blog Post</a></p>

{% if page_obj %}
    {% for blog in page_obj %}
        <article>
            {% if blog.featured_image %}
                <div style="margin-bottom: 10px;">
                    <img src="{{ blog.featured_image.url }}" alt="{{ blog.title }}" width="200" style="max-width: 100%; height: auto;">
                </div>
            {% endif %}
            <h3><a href="{% url 'blog_detail' blog.pk %}">{{ blog.title }}</a></h3>
            <p><strong>Category:</strong>
                {% if blog.category %}
                    <a href="{% url 'category_detail' blog.category.pk %}">{{ blog.category.name }}</a>
                {% else %}
                    Uncategorized
                {% endif %}
            </p>
            <p><strong>Created:</strong> {{ blog.created_at|date:"F d, Y G:i" }}</p>
            <p><strong>Updated:</strong> {{ blog.updated_at|date:"F d, Y G:i" }}</p>
            <p><strong>Status:</strong> {% if blog.is_published %}Published{% else %}Draft{% endif %}</p>
            <p><strong>Views:</strong> {{ blog.views }}</p>
            <p><strong>Likes:</strong> {{ blog.likes.count }}</p>
            <p>{{ blog.content|truncatewords:30 }}</p>
            <div class="actions">
                <a href="{% url 'blog_detail' blog.pk %}">View</a>
                <a href="{% url 'blog_update' blog.pk %}">Edit</a>
                <a href="{% url 'blog_delete' blog.pk %}">Delete</a>
            </div>
        </article>
        <hr>
    {% endfor %}

    <!-- Pagination -->
    <div class="pagination">
        <span class="page-info">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
            <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </div>
{% else %}
    <p>You haven't created any blog posts yet.</p>
    <p><a href="{% url 'blog_create' %}">Create your first blog post</a></p>
{% endif %}
{% endblock %}